<div class="container">
  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert error-message">
    {{ errorMessage }}
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="loading-spinner">
    Loading...
  </div>

  <!-- Project Details -->
  <div *ngIf="!loading && project">
    <h2>Edit Project: {{ project.name }}</h2>

    <!-- Edit Project Form -->
    <form (ngSubmit)="saveEdit()">
      <label for="projectName">Name:</label>
      <input id="projectName" [(ngModel)]="project.name" name="name" required>

      <label for="projectDescription">Description:</label>
      <textarea id="projectDescription" [(ngModel)]="project.description" name="description"></textarea>

      <button type="submit">Save Changes</button>
    </form>

    <!-- Add Collaborator -->
    <div *ngIf="canManageRole('USER')">
      <h3>Add Collaborator</h3>
      <form (ngSubmit)="addCollaborator(collaboratorEmail.value, collaboratorRole.value)">
        <label for="collaboratorEmail">Email:</label>
        <input #collaboratorEmail id="collaboratorEmail" type="email" required>

        <label for="collaboratorRole">Role:</label>
        <select #collaboratorRole id="collaboratorRole" required>
          <option *ngFor="let role of getAssignableRoles()" [value]="role">{{ role }}</option>
        </select>

        <button type="submit">Add Collaborator</button>
      </form>
    </div>

    <!-- Task Creation -->
    <div *ngIf="canManageRole('USER')">
      <h3>Create Task</h3>
      <form (ngSubmit)="createTask(taskName.value, taskDescription.value)">
        <label for="taskName">Task Name:</label>
        <input #taskName id="taskName" type="text" required>

        <label for="taskDescription">Description:</label>
        <textarea #taskDescription id="taskDescription" required></textarea>

        <button type="submit">Create Task</button>
      </form>
    </div>

    <!-- Task Assignment -->
    <div *ngIf="canAssignTasks()">
      <h3>Assign Task</h3>
      <form (ngSubmit)="assignTask(selectedTaskId.value, selectedUserId.value)">
        <label for="selectedTaskId">Task:</label>
        <select #selectedTaskId id="selectedTaskId" required>
          <option *ngFor="let task of tasks" [value]="task.id">{{ task.name }}</option>
        </select>

        <label for="selectedUserId">Assign to User:</label>
        <select #selectedUserId id="selectedUserId" required>
          <option *ngFor="let collaborator of collaborators" [value]="collaborator.user.id">{{ collaborator.user.name }}</option>
        </select>

        <button type="submit">Assign Task</button>
      </form>
    </div>
  </div>
</div>
